<div class="transactions-card">
  <div class="topbar">
    <h2>Transactions</h2>

    <div class="topbar-actions">
      <div class="search-box">
        <span class="pi pi-search"></span>
        <input type="text" placeholder="Search" />
      </div>

      <button class="left"><i class="pi pi-chevron-left"></i></button>
      <button class="right"><i class="pi pi-chevron-right"></i></button>

      <button class="btn-outline" (click)="toggleCalendar()">
        <i class="pi pi-calendar"></i> Start of account
      </button>

      <button class="btn-outline"><i class="pi pi-align-center"></i> Filters</button>
    </div>
  </div>

  <p-table [value]="filteredTransactions" sortMode="multiple">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id">ID <p-sortIcon field="id" /></th>

        <th pSortableColumn="date">
          Date
          <p-sortIcon field="date"></p-sortIcon>
          <p-columnFilter
            field="date"
            type="date"
            display="menu"
            dateFormat="dd/mm/yy"
          ></p-columnFilter>
        </th>

        <th pSortableColumn="from">From <p-sortIcon field="from" /></th>
        <th pSortableColumn="to">To <p-sortIcon field="to" /></th>
        <th pSortableColumn="type">Transaction Type <p-sortIcon field="type" /></th>
        <th pSortableColumn="status">Status <p-sortIcon field="status" /></th>
        <th pSortableColumn="currency">Currency <p-sortIcon field="currency" /></th>
        <th pSortableColumn="total">Total Amount <p-sortIcon field="total" /></th>
        <th pSortableColumn="amount">Amount <p-sortIcon field="amount" /></th>
        <th pSortableColumn="fee">Fee <p-sortIcon field="fee" /></th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-tx>
      <tr app-transactions-row [tx]="tx"></tr>
    </ng-template>
  </p-table>
</div>

<div class="date-popup-backdrop" *ngIf="showCalendar" (click)="closeCalendar()">
  <div class="date-popup" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="closeCalendar()">âœ•</button>

    <div class="date-popup-content">
      <div class="quick-options">
        <p (click)="filterToday()" [class.active]="activeQuickFilter === 'today'">Today</p>

        <p (click)="filterYesterday()" [class.active]="activeQuickFilter === 'yesterday'">
          Yesterday
        </p>

        <p (click)="filterCurrentWeek()" [class.active]="activeQuickFilter === 'week'">
          Current week
        </p>

        <p (click)="filterCurrentMonth()" [class.active]="activeQuickFilter === 'month'">
          Current month
        </p>

        <p (click)="resetPeriod()" [class.active]="activeQuickFilter === 'all'">Start of account</p>
      </div>

      <div class="calendar-box">
        <p-datepicker
          [(ngModel)]="selectedRange"
          selectionMode="range"
          [inline]="true"
          [numberOfMonths]="2"
          [firstDayOfWeek]="1"
        ></p-datepicker>

        <div class="popup-actions">
          <button class="cancel" (click)="closeCalendar()">Cancel</button>
          <button class="done" (click)="applyRange()">Done</button>

          <div class="right-actions">
            <p class="reset-period" (click)="resetPeriod()">Reset period</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
